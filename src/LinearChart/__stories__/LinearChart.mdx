

import {
   LinearChartExampleyDimensionUnit, LinearChartExampleLines, LinearChartExampleLinesNull, LinearChartExamplePercentY
} from './examples/LinearChartExample'

# LinearChart

Линейная диаграмма подходит, если вам нужно описать непрерывный процесс (или несколько)
с большим количеством значений. На такой диаграмме хорошо видно, как значения меняются,
и удобно сравнивать изменения в разных процессах.

- [Линии](#линии)
  - [Координаты точек](#координаты-точек)
  - [Конец и начало линии](#конец-и-начало-линии)
  - [Пропуск части значений](#пропуск-части-значений)
  - [Свойства линии](#свойства-линии)
- [Координатная сетка](#координатная-сетка)
  - [Подписи к делениям](#подписи-к-делениям)
  - [Где показывать](#где-показывать)
  - [Как часто](#как-часто)
  - [Сетка](#сетка)
- [Общие свойства](#общие-свойства-графика)
  - [Легенда](#легенда)
  - [Единицы измерения](#единицы-измерения)
  - [Формат подписи к делениям](#формат-подписи-к-делениям)
  - [Тултип](#тултип)
- [Предельные значения](#предельные-значения)
- [Лимиты](#лимиты)
- [Список свойств](#список-свойств)
- [Пример-использования](#примеры)


## Линии

### Координаты точек

На график можно добавить одну или несколько линий. За описание линий отвечает объект `line`.

Опишите координаты линий в объекте `value`. Каждая точка описывается через две координаты:

- `x` — координата по оси абсцисс,
- `y` — координата по оси ординат.

```ts
// values
[
  { x: 1, y: 1 },
  { x: 2, y: 0 },
  { x: 5, y: 3 },
  { x: 7, y: 1 },
  { x: 8, y: 2 },
]
```

#### Конец и начало линии

В точке, в которой нужно прервать линию, укажите `null`. Если укажете `null` в начале линии, она прервется в первой точке. Если укажете в конце, прервется в последней точке.

#### Пропуск части значений

Чтобы показать на графике пропуск (не показывать линию между двумя точками), укажите координаты точек, а между ними в промежуточных значениях добавьте `null`.

<LinearChartExampleLinesNull />

```ts
// values
[
  { x: 0, y: null },
  { x: 1, y: 1 },
  { x: 2, y: 0 },
  { x: 3, y: null },
  { x: 4, y: null },
  { x: 5, y: 3 },
  { x: 6, y: null },
  { x: 7, y: 1 },
  { x: 8, y: 2 },
  { x: 9, y: null },
]
```

### Свойства линии

За свойства линий отвечает объект `lines`. В него можно добавить несколько линий.

Название линии указывается в свойстве `lineName`.

Цвет линии указывается в свойстве `color`.

Еще можно:

- показать точки на линии в явном виде: `dots=true`.
- сделать всю линию пунктирной: `dashed=true`.
- вывести значения рядом с точками: `showValues=true`
- добавить градиент к линии: `withGradient=true`.

<LinearChartExampleLines />

```ts
[
  {
    values: [
      { x: 0, y: 0 },
      { x: 1, y: 1 },
      { x: 2, y: 0 },
      { x: 5, y: 3 },
      { x: 7, y: 1 },
      { x: 9, y: 3 },
    ],
    dots: true,
    dashed: true,
    showValues: true,
    lineName: 'Красивая линия',
    withGradient: true,
    color: 'var(--color-bg-normal)'
  },
]
```

## Координатная сетка

За координатную сетку отвечает `gridConfig`. Свойства указываются отдельно для каждой оси.

### Сетка

По умолчанию показывается сетка с шагом примерно 50 пикселей между делениями на осях (а значит, и между направляющими).

В `gridTicks` можно указать количество делений, которые вы хотите показать на графике. Правда, количество делений, которое появится на графике в итоге, может быть больше или меньше: его подбирает алгоритм.

Ещё можно:
- показать ось координакт (саму линию): `showGuide`,
- сделать график немного больше, чтобы показать, что он продолжается за пределами значений, которые вы указали для линий: `withPaddings`,
- зафиксировать минимальный размер шага между делениями:`limitMinimumStepSize` (шаг уменьшится до 30 пикселей и меньше становиться не будет),
- нарисовать сетку, которая не будет зависеть от самого графика, с помощью `min` и `max`. В `min` указываете значение первого деления на соответствующей оси, в `max` — последнее.

```ts
{
  "x": {
    "min": -1,
    "max": 10,
    "gridTicks": 10,
    "showGuide": true,
    "withPaddings": true
  },
  "y": {
    "min": 0,
    "labelTicks": 1,
    "showGuide": true,
    "withPaddings": false
  }
}
```

### Подписи к делениям

Подписи к делениями могут быть любыми. Вы можете определить их формат и расположить где и как удобно.

### Формат подписи к делениям

Вы можете указать, в каком формате выводить подпись к делениям, в свойстве `formatValueForLabel`.

По умолчанию рядом с делением выводится его номер на шкале (число в формате `number`).
Но можно указать что-то другое: например, дату или единицы измерения.

| Добавляет км к числу                | Выводит значения как даты                                     |
| ---------------------------------------- | ------------------------------------------------------------- |
| `formatValueForLabel={v =>`\${v} км`}`    | `formatValueForLabel={v => new Date(v).toLocaleDateString()}` |


Перевести все подписи к делениям в проценты по оси ординат можно с помощью `yLabelsShowInPercent`.

<LinearChartExamplePercentY />

Сделать подписи по оси абсцисс вертикальными можно с помощью `xLabelsShowVertical`.

Чтобы убрать подпись к первому делению по оси абсцисс, добавьте `xHideFirstLabel`.


## Общие свойства графика

### Легенда

Легенда нужна, чтобы показать описание линий на графике. Чтобы её добавить, используйте свойство `legend`.

Данные для легенды описываются в массиве `items`. Внутри:
- `color` — цвет линии (и точки в легенде, которая ее обозначает),
- `text` — подпись к этой линии.

Кроме этого, можно определить положение легенды:
- `align` указывает, как выровнять легенду относительно графика (слева, справа или по центру),
- `position` — где её разместить, сверху или снизу.


```tsx
items: [
  {
    color: colors.first,
    text: 'Успех',
  },
  {
    color: colors.second,
    text: 'Болъ',
  },
],
align: 'right',
position: 'bottom',
}
```

### Единицы измерения

За единицы измерения по оси ординат отвечает свойство `yDimensionUnit`.

<LinearChartExampleyDimensionUnit />

```tsx
yDimensionUnit="единицы"
```


### Тултип

При наведении на точку на линии показывается тултип — всплывающее окно с дополнительной информацией об этой точке.

Вы можете влиять на два параметра:

- формат заголовка — в нем отображается значение точки по оси `x` (за это отвечает свойство `formatValueForTooltipTitle`),
- формат отображения значения точки по оси `y` в самом тултипе (за это отвечает свойство `formatValueForTooltip`).

Тултип можно показывать при наведении на вертикаль, на которой находится точка, или при наведении на саму точку. За это отвечает свойство `tooltipVariant`.

По умолчанию тултип показывается при наведении на вертикаль (`tooltipVariant='line'`). Чтобы показывать его при наведении на точку, добавьте `tooltipVariant='dot'`.


## Предельные значения

За область предельных значений отвечает объект `threshold`.

Максимальные значения задаются в свойстве `max` (это обязательно), минимальные — в свойстве `min`.

Можно указать подписи для этих значений с помощью `label`.

```ts
{
  "max": {
    "values": [
      {
        "x": 1604651388343,
        "y": 6
      },
      {
        "x": 1604737788343,
        "y": 6
      }
    ],
    "label": "Максимум"
  },
  "min": {
    "values": [
      {
        "x": 1604651388343,
        "y": 1
      },
      {
        "x": 1604737788343,
        "y": 1
      }
    ],
    "label": "Минимум"
  }
}
```

## Свойства

<!-- props:start -->

| Свойство                                             | Тип                         | По умолчанию | Описание                                                                        |
| ---------------------------------------------------- | --------------------------- | ------------ | ------------------------------------------------------------------------------- |
| [`lines`](#свойства-линии)                           | [`Line[]`](#line)           | -            | Объект для описания линий                                                       |
| [`gridConfig`](#координатная-сетка)                  | [`GridConfig`](#gridconfig) | -            | Объект для описания координатной сетки                                          |
| [`threshold?`](#предельные-значения)                 | [`Threshold`](#threshold)   | -            | Объект для описания предельных значений                                         |
| [`legend?`](#легенда)                                | [`LegendProps`](#legend)    | -            | Объект для описания легенды                                                     |
| [`yDimensionUnit?`](#единицы-измерения)         | `string`                    | -            | Единицы измерения для оси ординат                                               |
| [`yLabelsShowInPercent?`](#формат-подписи-к-делениям)                              | `boolean`                   | `false`      | Переводит значения подписей делений оси ординат в проценты (0.1 -> 10%)         |
| [`xLabelsShowVertical?`](#формат-подписи-к-делениям)                               | `boolean`                   | `false`      | Переворачивает подписи делений оси абсцисс на 90° против часовой                |
| `xHideFirstLabel?`                                   | `boolean`                   | `false`      | Скрывает первую подпись к делению по оси абсцисс                                     |
| [`formatValueForLabel?`](#формат-подписи-к-делениям) | `(value: number) => string` | -            | Формат подписи к делению                                                        |
| [`formatValueForTooltip?`](#тултип)                  | `(value: number) => string` | -            | Формат подписи к делению для тултипа                                            |
| [`formatValueForTooltipTitle?`](#тултип)             | `(value: number) => string` | -            | Формат заголовка в тултипе                                                      |
| `onClickHoverLine?`                                  | `(value: number) => void`   | -            | Действие по клику на линию                                                      |
| `onClickHoverDot?`                                   | `(value: Item) => void`     | -            | Действие по клику на точку                                                      |
| [`limitMinimumStepSize?`](#сетка)                              | `boolean`                   | `false`      | Ограничивает минимальную ширину шага (в 30 пикселей)                              |
| [`tooltipVariant?`](#тултип)                         | `'dot'` , `'line'`           | `line`       | Отображает тултип при наведении на вертикаль или на точку на графике            |

### Line

| Ключ                                 | Тип               | По умолчанию | Описание                                                  |
| ------------------------------------ | ----------------- | ------------ | --------------------------------------------------------- |
| [`values`](#координаты-точек)        | `readonly Item[]` | -            | Набор координат для построения графика                    |
| [`lineName`](#свойства-линии)        | `string`          | -            | Название линии на графике                                 |
| [`color`](#свойства-линии)           | `string`          | -            | Цвет линии                                                |
| [`dots?`](#свойства-линии)           | `boolean`         | `false`      | Показывает точки на линии в явном виде                    |
| [`showValues?`](#свойства-линии)     | `boolean`         | `false`      | Выводит значение рядом с точкой                           |
| [`withGradient?`](#свойства-линии)   | `boolean`         | `false`      | Добавляет градиент под линией                             |
| [`dashed?`](#свойства-линии)         | `boolean`         | `false`      | Пунктирность линии                                        |

#### Line —> values

| Ключ                     | Тип      | По умолчанию | Описание                  |
| ------------------------ | -------- | ------------ | ------------------------- |
| [`x`](#координаты-точек) | `number` | -            | Координата по оси абсцисс |
| [`y`](#координаты-точек) | `number` | -            | Координата по оси ординат |

### GridConfig

Указывается по осям — отдельно для `x` и `y`.

| Ключ                                 | Тип                              | По умолчанию | Описание                                                                                                     |
| ------------------------------------ | -------------------------------- | ------------ | ------------------------------------------------------------------------------------------------------------ |
| [`min?`](#сетка)                     | `number`                         | -            | Начало отображения сетки координат                                                                           |
| [`max?`](#сетка)                     | `number`                         | -            | Конец отображения сетки координат                                                                            |
| [`gridTicks?`](#сетка)               | `number`                         | -            | Количество делений, которые видны на графике. По умолчанию 1 деление на ~50 пикселей                         |
| [`showGuide?`](#сетка)               | `boolean`                        | `true`       | Рисует линию оси                                                                                             |
| [`showGrid?`](#сетка)                | `boolean`                        | `true`       | Рисует линии сетки                                                                                           |
| [`withPaddings?`](#сетка)            | `boolean`                        | `false`      | Немного увеличивает график, чтобы можно было показать, что линия продолжается дальше                         |

### Threshold

| Ключ                            | Тип      | По умолчанию | Описание                                                           |
| ------------------------------- | -------- | ------------ | ------------------------------------------------------------------ |
| [`name?`](#предельные-значения) | `string` | -            | Имя предельного значения                                           |
| [`label?`](#предельные-значения)| `string` | -            | Подпись предельного значения                                       |
| [`max`](#предельные-значения)   | `Item[]` | -            | Массив с координатами точек, описывающий верхний порог ограничений |
| [`min?`](#предельные-значения)  | `Item[]` | -            | Массив с координатами точек, описывающий нижний порог ограничений  |

### Legend

| Ключ                            | Тип      | По умолчанию | Описание        |
| ------------------------------- | -------- | ------------ | ------------------------------------------|   
| [`items`](#легенда)   | `Item[]` | -            | Массив с данными для легенды |
| [`position?`](#легенда)  | `'top'`, `'bottom'` | `'top'` | Где показывать легенду: сверху или снизу от графика  |
| [`align?`](#легенда)  | `'left'`, `'center'`, `'right'` | `'center'` | Как выровнять легенду относительно графика  |


## Примеры

```tsx
import { LinearChart } from '@consta/widgets/LinearChart'

<LinearChart
  lines={[
    {
      values: [
        { x: 0, y: 0 },
        { x: 1, y: 1 },
        { x: 2, y: 0 },
        { x: 3, y: 2 },
        { x: 4, y: 4 },
        { x: 5, y: 3 },
        { x: 6, y: 2 },
        { x: 7, y: 1 },
        { x: 8, y: 2 },
        { x: 9, y: 5 },
      ],
      dots: true,
      lineName: 'Северный бур',
      withGradient: true,
      color: colors.first,
    },
  ]}
  gridConfig={{
    x: {
      showGuide: true,
      withPaddings: false,
    },
    y: {
      showGuide: true,
      withPaddings: false,
    },
  }}
  formatValueForLabel={String}
  yDimensionUnit="тыс м3"
/>
```
