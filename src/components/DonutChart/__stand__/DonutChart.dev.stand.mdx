import { MdxMenu } from '@consta/stand';
import {
  DonutChartExample,
  DonutChartZero,
  DonutChartZero3,
  DonutChartZeroPositive,
  DonutChartData4,
  DonutChartData40,
  DonutChartText,
  DonutChartTextTop,
  DonutChartTextRight,
  DonutChartTooltip,
  DonutChartHalfDonutTop,
  DonutChartHalfDonutBottom,
  DonutChartHalfDonutLeft,
  DonutChartHalfDonutRight,
  DonutChartLegendTop,
  DonutChartLegendRight,
  DonutChartLegendBottom,
  DonutChartLegendLeft,
  DonutChartExampleSums,
  DonutChartSort,
  DonutChartWithArcLabels,
} from './examples/DonutChartExample';

```tsx
import { DonutChart } from '@consta/widgets/DonutChart';
```

<MdxMenu>

- [Группы и линии](#группы-и-линии)
  - [Порядок отображения](#группы-и-линии)
  - [Сортировка](#сортировка)
  - [Максимальные значения](#максимальные-значения)
- [Текст](#текст-в-центре)
- [Тултип](#тултип)
- [Половина пончика](#половина-пончика)
- [Легенда](#легенда)
- [Список свойств](#свойства)
- [Пример использования](#пример)

</MdxMenu>

## Группы и линии

Цвет, величину и количество линий на диаграмме можно описать в объекте `data`. Внутри:

- `name` — название элемента,
- `color` — цвет элемента,
- `values` — значения для элемента.

Линии объединены в группы — круги. В одном круге может быть одна или несколько линий.
Кругов тоже может быть несколько, максимум 3 (иначе диаграмму будет
сложно воспринимать).

```ts
// data
[
  {
    name: 'Северный бур',
    color: colors.first,
    values: [1, 2, 3],
  },
  {
    name: 'Южный бур',
    color: colors.second,
    values: [4, 5, 6],
  },
  {
    name: 'Западный бур',
    color: colors.third,
    values: [7, 8, 9],
  },
];
```

| Три группы, все данные      | Ноль данных, одна группа          | Ноль данных, три группы        |
| --------------------------- | --------------------------------- | ------------------------------ |
| <DonutChartExample />       | <DonutChartZero />                | <DonutChartZero3 />            |
| **Данные в одной группе**   | **Без данных по группе частично** | **Без данных по одной группе** |
| <DonutChartZeroPositive  /> | <DonutChartData4  />              | <DonutChartData40  />          |

### Сортировка

По умолчанию значения на линии сортируются от меньшего к большему, отсчет начинается от 12 часов и идет по часовой стрелке.

Вы можете отсортировать значения с помощью `'sortValue'`:

- вывести в том порядке, в котором они приходят `sortValue={null}`
- или отсортировать от меньшего к большему.

### Максимальные значения

Вы можете установить максимальные значения для кругов в массиве `sums`.

Укажите число для каждого круга, по порядку. Если сумма значений в круге будет меньше максимума,
появятся «пропуски» (они заполняются другим цветом).

| Без максимумов        | `sums={[10,20,30]}`       |
| --------------------- | ------------------------- |
| <DonutChartExample /> | <DonutChartExampleSums /> |

## Текст в центре

За текст в центре «пончика» отвечает `textData`. Внутри:

- `value` — крупное число — основное значение, которое нужно показать на диаграмме
- `label` — крупный текст

Текст будет виден, если на диаграмме только один круг.

Все данные будут видны только при [`halfDonut="left"`](#половина-пончика) или [`halfDonut="right"`](#половина-пончика).

| В круге — только число | В полукруге сверху или снизу | В полукруге слева или справа |
| ---------------------- | ---------------------------- | ---------------------------- |
| <DonutChartText />     | <DonutChartTextTop />        | <DonutChartTextRight />      |

> Размер текста расчитывается автоматически до определенного минимального значения, чтобы идеально вписать текст в окружность.

## Тултип

При наведении на круг показывается тултип — всплывающее окно с информацией
обо всех линиях: название, цвет, значение.

Вы можете поменять формат значения в тултипе — за это отвечает свойство `formatValueForTooltip`.
Например, добавить к значению единицы измерения.

<DonutChartTooltip />

```ts
formatValueForTooltip={v => `${v} км`}
```

## Половина пончика

Вместо круговой диаграммы можно показать полукруг (пропорции значений сохраняются).
За это отвечает свойство `halfDonut`. Варианты: `'top'`, `'left'`, `'right'`, `'bottom'`.

| `halfDonut="top"`          | `halfDonut="bottom"`          |
| -------------------------- | ----------------------------- |
| <DonutChartHalfDonutTop /> | <DonutChartHalfDonutBottom /> |

| `halfDonut="left"`          | `halfDonut="right"`          |
| --------------------------- | ---------------------------- |
| <DonutChartHalfDonutLeft /> | <DonutChartHalfDonutRight /> |

## Легенда

Легенда нужна, чтобы показать описание на диаграмме — в явном виде показать названия линий
и какому цвету они соответствуют.

Чтобы добавить легенду, используйте свойство `legendPosition`. Варианты: `'top'`, `'right'`, `'left'` и `'bottom'`.

| `legendPosition="top"`  | `legendPosition="right"`  |
| ----------------------- | ------------------------- |
| <DonutChartLegendTop /> | <DonutChartLegendRight /> |

| `legendPosition="bottom""` | `legendPosition="left"`  |
| -------------------------- | ------------------------ |
| <DonutChartLegendBottom /> | <DonutChartLegendLeft /> |

## Подписи дуг окружности

<DonutChartWithArcLabels />

## Свойства

| Свойство                            | Тип                                                      | По умолчанию                                 | Описание                                                                                                                                   |
| ----------------------------------- | -------------------------------------------------------- | -------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| [`data`](#группы-и-линии)           | [`readonly DonutData[]`](#donutdata)                     | -                                            | Массив с описанием линий — данных, которые нужно представить на диаграмме                                                                  |
| [`value?`](#текст-в-центре)         | `string`                                                 | -                                            | Крупное число (основное значение)                                                                                                          |
| [`label?`](#текст-в-центре)         | `string`                                                 | -                                            | Крупный текст                                                                                                                              |
| [`halfDonut?`](#половина-пончика)   | `'top'`, `'left'`, `'right'`, `'bottom'`                 | -                                            | Показывает половинку круга                                                                                                                 |
| [`valueSize?`](#текст-в-центре)     | `number`                                                 | -                                            | Размер текста                                                                                                                              |
| [`formatValueForTooltip?`](#тултип) | `string`                                                 | -                                            | Формат значения в тултипе                                                                                                                  |
| [`sums?`](#максимальные-значения)   | `readonly number[]`                                      | -                                            | Массив максимальных значений для окружности. Если сумма всех дуг меньше максимального значения, оставшееся место заполняется другим цветом |
| [`sortValue?`](#сортировка)         | `((prev: DataItem, next: DataItem) => number)` \| `null` | `(prev: DataItem, next: DataItem) => number` | Метод сортировки значений, по умолчанию сортирует от большего к меньшему                                                                   |
| [`legendPosition?`](#легенда)       | `'top', 'right', 'left', 'bottom'`                       | -                                            | Определяет необходимость отображения легенды, и ее положение относительно графика                                                          |
| `showArcLabels?`                    | `boolean`                                                | -                                            | Показывает или скрывает отображение подписей к дугам первой окружности                                                                     |
| `formatArcLabel?`                   | `(item: ArcDataItem) => string`                          | `(item: ArcDataItem) => string`              | Метод форматирования подписей к дугам, позволяет настроить что выводить                                                                    |
| `arcLabelSize?`                     | `'xs', 's'`                                              | `'s'`                                        | Размер подписей к дугам                                                                                                                    |
| `onClick?`                          | `MouseEventHandler`                                      | -                                            | Обработчик нажатия по графику                                                                                                              |
| `onClickPie?`                       | `(items: readonly ArcDataItem[]) => void`                | -                                            | Обработчик нажатия для кольца графика                                                                                                      |
| `onClickArc?`                       | `(item: ArcDataItem) => void`                            | -                                            | Обработчик нажатия для дуги графика                                                                                                        |

### DonutData

| Свойство                   | Тип      | По умолчанию | Описание       |
| -------------------------- | -------- | ------------ | -------------- |
| [`name`](#группы-и-линии)  | `string` | -            | Название линии |
| [`color`](#группы-и-линии) | `string` | -            | Цвет линии     |
| [`value`](#группы-и-линии) | `string` | -            | Значение       |

## Пример

```tsx
import React from 'react';
import { DonutChart } from '@consta/widgets/DonutChart';

const SomeComponent = () => (
  <DonutChart
    data={[
      {
        color: 'var(--color-bg-normal)',
        name: 'Северный бур',
        values: [10, 5],
      },
      {
        color: 'var(--color-bg-alert)',
        name: 'Южный бур',
        values: [5, 10],
      },
    ]}
  />
);
```
